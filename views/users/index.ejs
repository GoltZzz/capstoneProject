<%- layout('layouts/boilerplate') %>

<h1 style="text-align: center; margin-top: 20px; font-size: 2rem; color: #333">
	Admin Dashboard
</h1>
<main class="container mt-5 container-fluid">
	<div
		class="dashboard-stats"
		style="
			display: flex;
			justify-content: space-around;
			margin: 20px auto;
			flex-wrap: wrap;
		">
		<p
			style="
				font-size: 1.2rem;
				padding: 10px;
				background-color: #f8f9fa;
				border-radius: 8px;
				box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
			">
			<strong>Total Users:</strong> <%= usersCount %>
		</p>
	</div>

	<div
		class="dashboard-grid"
		style="
			display: grid;
			grid-template-columns: 1fr 2fr;
			gap: 20px;
			margin: 20px;
		">
		<div class="notifications-section">
			<h2 style="font-size: 1.5rem; margin-bottom: 15px; display: inline-block">
				Notifications
			</h2>
			<button
				class="btn btn-sm btn-secondary hide-all-notifications"
				style="float: right; margin-left: 10px">
				Hide All
			</button>
			<button
				class="btn btn-sm btn-secondary show-all-notifications"
				style="float: right">
				Show All
			</button>
			<ul style="list-style: none; padding: 0; margin: 0">
				<% notifications.reverse().forEach(notification => { %>
				<li
					class="notification"
					style="
						padding: 15px;
						background: #f1f1f1;
						margin-bottom: 10px;
						border-radius: 5px;
						box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
					">
					<strong>From:</strong>
					<a href="/notifications/<%= notification._id %>"
						><%= notification.name %></a
					>
					<br />
					<strong>Message:</strong> <%= notification.message %>
					<br />
					<strong>Location Title:</strong> <%= notification.location ?
					notification.location.title : 'No Location' %>
					<br />
					<strong>Location Details:</strong> <%= notification.location ?
					notification.location.location : 'No Location Details' %>
				</li>
				<% }); %>
			</ul>
		</div>

		<div
			class="users-table-wrapper"
			style="
				overflow-x: auto;
				padding: 10px;
				background: #ffffff;
				border-radius: 8px;
				box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			">
			<table
				class="admin-dashboard-table"
				style="width: 100%; border-collapse: collapse; margin: 0 auto">
				<thead style="background: #007bff; color: #fff">
					<tr>
						<th style="text-align: center; padding: 10px">Username</th>
						<th style="text-align: center; padding: 10px">Email</th>
						<th style="text-align: center; padding: 10px">First Name</th>
						<th style="text-align: center; padding: 10px">Last Name</th>
						<th style="text-align: center; padding: 10px">Admin</th>
						<th style="text-align: center; padding: 10px">Avatar</th>
					</tr>
				</thead>
				<tbody>
					<% users.forEach(user => { %>
					<tr style="background: #f9f9f9; border-bottom: 1px solid #ddd">
						<td style="text-align: center; padding: 15px">
							<a
								href="/admin/users/<%= user._id %>"
								style="color: #007bff; text-decoration: none"
								><%= user.username %></a
							>
						</td>
						<td style="text-align: center; padding: 15px"><%= user.email %></td>
						<td style="text-align: center; padding: 15px">
							<%= user.firstName %>
						</td>
						<td style="text-align: center; padding: 15px">
							<%= user.lastName %>
						</td>
						<td style="text-align: center; padding: 15px">
							<%= user.isAdmin ? 'Yes' : 'No' %>
						</td>
						<td style="text-align: center; padding: 15px">
							<% if (user.avatars && user.avatars.length > 0 && user.avatars[0]
							&& user.avatars[0].url) { %>
							<img
								src="<%= user.avatars[0].url %>"
								alt="Avatar"
								style="
									width: 80px;
									height: 80px;
									border-radius: 50%;
									object-fit: cover;
								" />
							<% } else { %> No Avatar <% } %>
						</td>
					</tr>
					<% }); %>
				</tbody>
			</table>
		</div>
	</div>
</main>
