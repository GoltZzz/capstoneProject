<% layout('layouts/boilerplate') %>
<div id="map" style="width: 100%; height: 500px"></div>
<h1 class="mt-3">All Devices</h1>
<form
	action="/sfas"
	method="get"
	class="form-inline d-flex justify-content-end">
	<div class="form-group mb-3 me-2 w-50">
		<input
			type="text"
			name="search"
			id="search"
			placeholder="Search"
			class="form-control p-3" />
	</div>
	<button type="submit" class="btn btn-lg btn-block mb-3 search-button">
		üîç
	</button>
</form>
<div class="container">
	<%for(let location of locations){%>
	<div class="card mb-3 shadow">
		<div class="row">
			<div class="col-md-4">
				<% if (location.images.length) { %>
				<img
					crossorigin="anonymous"
					class="img-fluid"
					alt=""
					src="<%= location.images[0].url %>" />
				<% }else{ %>
				<img
					crossorigin="anonymous"
					class="img-fluid"
					alt=""
					src="https://images.unsplash.com/photo-1561439740-e8863909de77?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Nzh8fGZpcmVmaWdodGVyfGVufDB8fDB8fHww" />
				<% } %>
			</div>
			<div class="col-md-8">
				<div class="card-body">
					<h5 class="card-title"><%= location.title %></h5>
					<p class="card-text"><%= location.description %></p>
					<p class="card-text">
						<small class="text-muted"><%= location.location %></small>
					</p>
					<a href="/sfas/<%= location._id %>" class="btn btn-primary"
						>View <%= location.title %></a
					>
				</div>
			</div>
		</div>
	</div>
	<% } %>
</div>

<script>
	const maptilerApiKey = '<%- process.env.MAPTILER_API_KEY %>';
	const locations = {features: <%- JSON.stringify(locations) %>};
</script>
<script src="/javascripts/clusterMap.js"></script>
