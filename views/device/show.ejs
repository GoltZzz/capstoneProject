<% layout('layouts/boilerplate') %>
<link rel="stylesheet" href="/stylesheets/stars.css" />

<div class="row">
	<div class="col-6">
		<div id="locationCarousel" class="carousel slide">
			<div class="carousel-inner">
				<% location.images.forEach((image, i) =>{ %>
				<div class="carousel-item <%= i === 0 ? 'active' : '' %>">
					<img
						src="<%= image.url %>"
						class="d-block w-100"
						crossorigin="anonymous" />
				</div>
				<% }) %>
			</div>
			<% if(location.images.length > 1) {%>
			<button
				class="carousel-control-prev"
				type="button"
				data-bs-target="#locationCarousel"
				data-bs-slide="prev">
				<span class="carousel-control-prev-icon" aria-hidden="true"></span>
				<span class="visually-hidden">Previous</span>
			</button>
			<button
				class="carousel-control-next"
				type="button"
				data-bs-target="#locationCarousel"
				data-bs-slide="next">
				<span class="carousel-control-next-icon" aria-hidden="true"></span>
				<span class="visually-hidden">Next</span>
			</button>
			<% } %>
		</div>

		<div class="card mb-3">
			<div class="card-body">
				<h5 class="card-title"><%= location.title %></h5>
				<p class="card-text"><%= location.description %></p>
			</div>
			<ul class="list-group list-group-flush">
				<li class="list-group-item text-muted"><%= location.location %></li>
				<li class="list-group-item">
					Owned By: <%= location.owner.username %>
				</li>
			</ul>
			<% if( currentUser && currentUser.isAdmin) {%>
			<div class="card-body">
				<a class="card-link btn btn-info" href="/sfas/<%= location._id  %>/edit"
					>Edit Device</a
				>
				<form
					class="d-inline"
					action="/sfas/<%= location._id%>?_method=DELETE"
					method="post">
					<button class="btn btn-danger card-link">Delete Device</button>
				</form>
			</div>
			<% } %>
			<div class="card-footer text-muted">
				<a href="/sfas">All Devices</a>
			</div>
		</div>
	</div>
	<div class="col-6">
		<div id="map" class="h-100"></div>
	</div>
</div>

<script>
	const maptilerApiKey = '<%- process.env.MAPTILER_API_KEY %>';
	const locations = <%- JSON.stringify(location) %>
</script>
<script src="/javascripts/showPageMap.js"></script>
